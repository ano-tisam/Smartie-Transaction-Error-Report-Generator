<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction Report Generator</title>
    <!-- Tailwind CSS from CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Use Inter font -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #1f2937;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Main Container -->
    <div class="bg-white p-8 md:p-12 rounded-2xl shadow-xl w-full max-w-2xl border border-gray-200">
        <h1 class="text-3xl md:text-4xl font-extrabold text-center text-gray-800 mb-6">Transaction Report Generator</h1>
        <p class="text-center text-gray-600 mb-8">Fill out the details below to generate a pre-formatted report sentence.</p>

        <!-- Input Form -->
        <div class="space-y-6">
            <!-- Name Input -->
            <div>
                <label for="userName" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                <input type="text" id="userName" placeholder="e.g., Alex Johnson" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-shadow">
            </div>

            <!-- Amount Input -->
            <div>
                <label for="amount" class="block text-sm font-medium text-gray-700 mb-1">Amount</label>
                <input type="text" id="amount" placeholder="e.g., $100.00" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-shadow">
            </div>

            <!-- Date Input -->
            <div>
                <label for="date" class="block text-sm font-medium text-gray-700 mb-1">Date</label>
                <input type="text" id="date" placeholder="e.g., January 1, 2024" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-shadow">
            </div>

            <!-- Transaction ID Input -->
            <div>
                <label for="transactionId" class="block text-sm font-medium text-gray-700 mb-1">Transaction ID</label>
                <input type="text" id="transactionId" placeholder="e.g., 0x123abc..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-shadow">
            </div>

            <!-- Wallet Address Input -->
            <div>
                <label for="walletAddress" class="block text-sm font-medium text-gray-700 mb-1">Wallet Address</label>
                <input type="text" id="walletAddress" placeholder="e.g., 0xabc456..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition-shadow">
            </div>
        </div>

        <!-- Buttons -->
        <div class="mt-8 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4">
            <button id="generateBtn" class="flex-1 bg-blue-600 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500">
                Generate Report
            </button>
            <button id="copyBtn" class="flex-1 bg-gray-200 text-gray-800 font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-gray-300 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400">
                Copy to Clipboard
            </button>
        </div>
        
        <!-- Output Display -->
        <div class="mt-8 p-6 bg-gray-100 border border-gray-200 rounded-lg shadow-inner">
            <h3 class="text-sm font-medium text-gray-700 mb-2">Generated Sentence:</h3>
            <p id="output" class="text-gray-800 leading-relaxed break-words"></p>
        </div>
        
        <!-- Custom Alert Modal -->
        <div id="alertModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4">
            <div class="bg-white p-6 rounded-lg shadow-xl max-w-sm w-full">
                <h3 class="text-lg font-bold text-gray-800 mb-2">Error</h3>
                <p id="alertMessage" class="text-gray-700 mb-4"></p>
                <button id="closeAlertBtn" class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition-colors">OK</button>
            </div>
        </div>

    </div>

    <script>
        const userNameInput = document.getElementById('userName');
        const amountInput = document.getElementById('amount');
        const dateInput = document.getElementById('date');
        const transactionIdInput = document.getElementById('transactionId');
        const walletAddressInput = document.getElementById('walletAddress');
        const generateBtn = document.getElementById('generateBtn');
        const copyBtn = document.getElementById('copyBtn');
        const outputDisplay = document.getElementById('output');
        const alertModal = document.getElementById('alertModal');
        const alertMessage = document.getElementById('alertMessage');
        const closeAlertBtn = document.getElementById('closeAlertBtn');

        // Function to show a custom alert modal
        function showAlert(message) {
            alertMessage.textContent = message;
            alertModal.classList.remove('hidden');
            alertModal.classList.add('flex');
        }

        // Function to close the custom alert modal
        function closeAlert() {
            alertModal.classList.remove('flex');
            alertModal.classList.add('hidden');
        }
        closeAlertBtn.addEventListener('click', closeAlert);

        // Event listener for the Generate button
        generateBtn.addEventListener('click', () => {
            const name = userNameInput.value.trim();
            const amount = amountInput.value.trim();
            const date = dateInput.value.trim();
            const transactionId = transactionIdInput.value.trim();
            const walletAddress = walletAddressInput.value.trim();

            // Simple validation to ensure all fields are filled
            if (!name || !amount || !date || !transactionId || !walletAddress) {
                showAlert("Please fill in all of the fields.");
                return;
            }

            // Construct the final sentence using string interpolation
            const reportText = `Issue: User ${name} transferred ${amount} on the ${date} with transaction ${transactionId} but forgot to include their wallet address. Resolution: Looked up their Add Money transaction to confirm the ${amount} transfer and then added their wallet address ${walletAddress} manually to assign payment to their wallet.`;

            // Display the generated text
            outputDisplay.textContent = reportText;
        });

        // Event listener for the Copy button
        copyBtn.addEventListener('click', () => {
            const textToCopy = outputDisplay.textContent;

            if (textToCopy) {
                // Use the deprecated but reliable document.execCommand for copying in iframes
                const tempTextArea = document.createElement('textarea');
                tempTextArea.value = textToCopy;
                document.body.appendChild(tempTextArea);
                tempTextArea.select();
                try {
                    document.execCommand('copy');
                    showAlert("Text copied to clipboard!");
                } catch (err) {
                    console.error('Failed to copy text: ', err);
                    showAlert("Failed to copy text. Please try again or copy manually.");
                } finally {
                    document.body.removeChild(tempTextArea);
                }
            } else {
                showAlert("Please generate a sentence first.");
            }
        });

    </script>
</body>
</html>
